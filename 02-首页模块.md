## 1. 首页

### 1.1 首页轮播图

![image-20230226225413208](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226225413208.png)

布局分析：

`scr/components/XtxCarousel.vue`

![image-20230226225524559](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226225524559.png)

接口调用：

接口地址：/home/banner

请求方式：GET

登录权限: 否

请求参数：

**Query:**

| 字段名称         | 是否必须 | 默认值 | 备注                                                 |
| ---------------- | -------- | ------ | ---------------------------------------------------- |
| distributionSite | 否       | 1      | 活动banner位置，1代表首页，2代表商品分类页，默认为 1 |

成功响应结果：

| 字段名称 | 数据类型 | 备注     |
| -------- | -------- | -------- |
| id       | String   | ID       |
| imgUrl   | String   | 图片路径 |

```tsx
/**
 * 首页-广告区域
 * @param distributionSite 说明：广告区域展示位置（投放位置 投放位置，1为首页，2为分类商品页） 默认是1
 */
export function getHomeBanner(distributionSite = 1) {
  return http<BannerItem[]>({
    method: 'GET',
    url: '/home/banner',
    data: {
      distributionSite: distributionSite
    }
  });
}
```

### 1.2 前台类目

![image-20230226230031800](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226230031800.png)

布局分析：

![image-20230226230142132](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226230142132.png)

接口调用：

接口地址：/home/category/head/mutli

请求方式：GET

登录权限: 否

请求参数：无

成功响应结果：

| 字段名称 | 数据类型 | 备注     |
| -------- | -------- | -------- |
| id       | String   | ID       |
| icon     | String   | 图片路径 |
| name     | String   | 类目名称 |

```tsx
/**
 * 首页-类别区域
 * @param
 */
export function getHomeCategoryHeadMutli() {
  return http<CategoryItem[]>({
    method: 'GET',
    url: '/home/category/mutli'
  });
}
```

这里分类的数据是考虑了不止一页数据的情况，采取了使用 `Map` 的形式以 `page` 为 `key` 去分类存储对应页的数据，然后利用分类好的 `Map` 的长度去算出容器的宽度和光标的宽度

![image-20230226230920882](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226230920882.png)

### 1.3 人气推荐 & 新鲜好物

![image-20230226231036602](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226231036602.png)

布局分析：

🔥人气推荐

![image-20230226231153942](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226231153942.png)

接口调用：

接口地址：/home/hot/mutli

请求方式：GET

登录权限: 否

请求参数：

**Headers:**

| 字段名称      | 是否必须 | 默认值 | 备注                                         |
| ------------- | -------- | ------ | -------------------------------------------- |
| source-client | 是       | 无     | 后端程序区分接口调用者，miniapp 代表小程序端 |

成功响应结果：

| 字段名称 | 数据类型 | 备注             |
| -------- | -------- | ---------------- |
| id       | String   | ID               |
| title    | String   | 推荐类型名称     |
| type     | Number   | 推荐类别         |
| alt      | String   | 推荐类型名称说明 |
| pictures | Array    | 图片地址         |

```tsx
/**
 * 首页-人气推荐
 * @param
 */
export function getHomeMutli() {
  return http<HotItem[]>({
    method: 'GET',
    url: '/home/hot/mutli'
  });
}
```

🍒新鲜好物

![image-20230226231259025](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226231259025.png)

接口调用：

接口地址：/home/new

请求方式：GET

登录权限: 否

请求参数：

**Query:**

| 字段名称 | 是否必须 | 默认值 | 备注                   |
| -------- | -------- | ------ | ---------------------- |
| limit    | 否       | 4      | 获取新鲜好物商品的个数 |

成功响应结果：

| 字段名称 | 数据类型 | 备注     |
| -------- | -------- | -------- |
| id       | String   | ID       |
| name     | String   | 商品名称 |
| price    | Number   | 商品价格 |
| picture  | String   | 商品图片 |

```tsx
/**
 * 首页-新鲜好物
 * @param
 */
export function getHomeNewList() {
  return http<NewItem[]>({
    method: 'GET',
    url: '/home/new'
  });
}
```

### 1.4 猜你喜欢

src/components/XtxResult.vue

![image-20230226231601668](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226231601668.png)

布局分析：

![image-20230226231730262](https://cdn.jsdelivr.net/gh/zengzjie/picgo-image@main/static_files/image-20230226231730262.png)

接口调用：

接口地址：/home/goods/guessLike

请求方式：GET

登录权限: 否

请求参数：

**Query:**

| 字段名称 | 是否必须 | 默认值 | 备注           |
| -------- | -------- | ------ | -------------- |
| page     | 否       | 1      | 分页的页码     |
| pageSize | 否       | 10     | 每页数据的条数 |

成功响应结果，**pages 的含义为所有商品数据总的页数，items 为每页的商品数据**

| 字段名称 | 数据类型 | 备注         |
| -------- | -------- | ------------ |
| counts   | Number   | 商品总数量   |
| page     | Number   | 分页页码     |
| pageSize | Number   | 每页商品数量 |
| pages    | Number   | 总页数       |
| items    | Array    | 商品列表     |

**items**

| 字段名称 | 数据类型 | 备注     |
| -------- | -------- | -------- |
| id       | String   | ID       |
| name     | String   | 商品名称 |
| price    | Number   | 商品价格 |
| picture  | String   | 商品图片 |

```tsx
/**
 * 首页-猜你喜欢
 * @param
 */
export function getGuessLike(data: GetHomeGoodsGuessLikeData) {
  return http<PageResult<GuessItem>>({
    method: 'GET',
    url: '/home/goods/guessLike',
    data
  });
}
```

首屏的数据渲染（onLoad时加载猜你喜欢数据）

外层是套用 `scroll-view` 标签在滚动到底部时渲染更多数据，然后将数据追加到现有的数据中。

在请求之前先判断数据是否已经全部加载完了则不必要再次发起请求了。

`scroll-view` 默认支持下拉刷新的功能，通过简单的配置就可以实现了：

- 配置 refresher-enabled 属性，开启下拉刷新交互
- 监听 refresherrefresh 事件，判断用户是否执行了下拉操作
- 配置 refresher-triggered 属性，关闭下拉状态